import{jsx as b,jsxs as W}from"https://esm.sh/react/jsx-runtime";import{createRoot as _e}from"https://esm.sh/react-dom/client";import{useEffect as Se,useRef as Te,useState as Re}from"https://esm.sh/react";import{unstableSetRender as Ie,theme as Oe,Input as Pe,Typography as P,notification as ze,Flex as A,ConfigProvider as De,Tooltip as ve,Radio as ne,Checkbox as ge,Table as Ue,Spin as We,Tag as re,Button as oe,Alert as Ae}from"https://esm.sh/antd?standalone";import{GithubOutlined as Me,YoutubeOutlined as Ee,TwitterOutlined as He,SunOutlined as qe,MoonOutlined as Ne,DownloadOutlined as ce}from"https://esm.sh/@ant-design/icons?standalone";import Ge from"https://esm.sh/fuse.js?standalone";import{File as te,encode as le,Fmt as fe,decode as F,guess as ee}from"https://esm.sh/@easy-install/easy-archive?standalone";import{COLORS as ue,Rgb as Ke}from"https://esm.sh/e-color?standalone";import{create as Ze}from"https://esm.sh/zustand?standalone";import{persist as Je,createJSONStorage as Ve}from"https://esm.sh/zustand?standalone/middleware";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))h(m);new MutationObserver(m=>{for(const f of m)if(f.type==="childList")for(const l of f.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&h(l)}).observe(document,{childList:!0,subtree:!0});function a(m){const f={};return m.integrity&&(f.integrity=m.integrity),m.referrerPolicy&&(f.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?f.credentials="include":m.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function h(m){if(m.ep)return;m.ep=!0;const f=a(m);fetch(m.href,f)}})();const Xe="apng,avif,bmp,gif,j2k,jp2,jfif,jpeg,jpg,jxl,mj2,png,svg,tga,tif,tiff,webp".split(",");function Ye(r,o){if(!r?.length)return!1;for(const a of o){if(a.length===0)return!r.includes(".");if(r.endsWith(`.${a}`))return!0}return!1}function pe(r,o=Xe){return Ye(r.toLocaleLowerCase(),o)}const Qe=64;new Array(Qe).map(()=>!1);var de=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fe(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var o=r.default;if(typeof o=="function"){var a=function h(){var m=!1;try{m=this instanceof h}catch{}return m?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};a.prototype=o.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(r).forEach(function(h){var m=Object.getOwnPropertyDescriptor(r,h);Object.defineProperty(a,h,m.get?m:{enumerable:!0,get:function(){return r[h]}})}),a}var ie={exports:{}};function et(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var se={exports:{}};const tt={},nt=Object.freeze(Object.defineProperty({__proto__:null,default:tt},Symbol.toStringTag,{value:"Module"})),rt=Fe(nt);var ot=se.exports,we;function at(){return we||(we=1,function(r,o){(function(a,h){r.exports=h()})(ot,function(){var a=a||function(h,m){var f;if(typeof window<"u"&&window.crypto&&(f=window.crypto),typeof self<"u"&&self.crypto&&(f=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(f=globalThis.crypto),!f&&typeof window<"u"&&window.msCrypto&&(f=window.msCrypto),!f&&typeof de<"u"&&de.crypto&&(f=de.crypto),!f&&typeof et=="function")try{f=rt}catch{}var l=function(){if(f){if(typeof f.getRandomValues=="function")try{return f.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof f.randomBytes=="function")try{return f.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},p=Object.create||function(){function s(){}return function(u){var d;return s.prototype=u,d=new s,s.prototype=null,d}}(),k={},c=k.lib={},C=c.Base=function(){return{extend:function(s){var u=p(this);return s&&u.mixIn(s),(!u.hasOwnProperty("init")||this.init===u.init)&&(u.init=function(){u.$super.init.apply(this,arguments)}),u.init.prototype=u,u.$super=this,u},create:function(){var s=this.extend();return s.init.apply(s,arguments),s},init:function(){},mixIn:function(s){for(var u in s)s.hasOwnProperty(u)&&(this[u]=s[u]);s.hasOwnProperty("toString")&&(this.toString=s.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),_=c.WordArray=C.extend({init:function(s,u){s=this.words=s||[],u!=m?this.sigBytes=u:this.sigBytes=s.length*4},toString:function(s){return(s||w).stringify(this)},concat:function(s){var u=this.words,d=s.words,y=this.sigBytes,x=s.sigBytes;if(this.clamp(),y%4)for(var L=0;L<x;L++){var R=d[L>>>2]>>>24-L%4*8&255;u[y+L>>>2]|=R<<24-(y+L)%4*8}else for(var T=0;T<x;T+=4)u[y+T>>>2]=d[T>>>2];return this.sigBytes+=x,this},clamp:function(){var s=this.words,u=this.sigBytes;s[u>>>2]&=4294967295<<32-u%4*8,s.length=h.ceil(u/4)},clone:function(){var s=C.clone.call(this);return s.words=this.words.slice(0),s},random:function(s){for(var u=[],d=0;d<s;d+=4)u.push(l());return new _.init(u,s)}}),B=k.enc={},w=B.Hex={stringify:function(s){for(var u=s.words,d=s.sigBytes,y=[],x=0;x<d;x++){var L=u[x>>>2]>>>24-x%4*8&255;y.push((L>>>4).toString(16)),y.push((L&15).toString(16))}return y.join("")},parse:function(s){for(var u=s.length,d=[],y=0;y<u;y+=2)d[y>>>3]|=parseInt(s.substr(y,2),16)<<24-y%8*4;return new _.init(d,u/2)}},$=B.Latin1={stringify:function(s){for(var u=s.words,d=s.sigBytes,y=[],x=0;x<d;x++){var L=u[x>>>2]>>>24-x%4*8&255;y.push(String.fromCharCode(L))}return y.join("")},parse:function(s){for(var u=s.length,d=[],y=0;y<u;y++)d[y>>>2]|=(s.charCodeAt(y)&255)<<24-y%4*8;return new _.init(d,u)}},v=B.Utf8={stringify:function(s){try{return decodeURIComponent(escape($.stringify(s)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(s){return $.parse(unescape(encodeURIComponent(s)))}},g=c.BufferedBlockAlgorithm=C.extend({reset:function(){this._data=new _.init,this._nDataBytes=0},_append:function(s){typeof s=="string"&&(s=v.parse(s)),this._data.concat(s),this._nDataBytes+=s.sigBytes},_process:function(s){var u,d=this._data,y=d.words,x=d.sigBytes,L=this.blockSize,R=L*4,T=x/R;s?T=h.ceil(T):T=h.max((T|0)-this._minBufferSize,0);var O=T*L,z=h.min(O*4,x);if(O){for(var D=0;D<O;D+=L)this._doProcessBlock(y,D);u=y.splice(0,O),d.sigBytes-=z}return new _.init(u,z)},clone:function(){var s=C.clone.call(this);return s._data=this._data.clone(),s},_minBufferSize:0});c.Hasher=g.extend({cfg:C.extend(),init:function(s){this.cfg=this.cfg.extend(s),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(s){return this._append(s),this._process(),this},finalize:function(s){s&&this._append(s);var u=this._doFinalize();return u},blockSize:16,_createHelper:function(s){return function(u,d){return new s.init(d).finalize(u)}},_createHmacHelper:function(s){return function(u,d){return new j.HMAC.init(s,d).finalize(u)}}});var j=k.algo={};return k}(Math);return a})}(se)),se.exports}var it=ie.exports,be;function st(){return be||(be=1,function(r,o){(function(a,h){r.exports=h(at())})(it,function(a){return function(h){var m=a,f=m.lib,l=f.WordArray,p=f.Hasher,k=m.algo,c=[];(function(){for(var v=0;v<64;v++)c[v]=h.abs(h.sin(v+1))*4294967296|0})();var C=k.MD5=p.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,g){for(var j=0;j<16;j++){var s=g+j,u=v[s];v[s]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360}var d=this._hash.words,y=v[g+0],x=v[g+1],L=v[g+2],R=v[g+3],T=v[g+4],O=v[g+5],z=v[g+6],D=v[g+7],q=v[g+8],N=v[g+9],G=v[g+10],E=v[g+11],K=v[g+12],Z=v[g+13],H=v[g+14],J=v[g+15],e=d[0],t=d[1],n=d[2],i=d[3];e=_(e,t,n,i,y,7,c[0]),i=_(i,e,t,n,x,12,c[1]),n=_(n,i,e,t,L,17,c[2]),t=_(t,n,i,e,R,22,c[3]),e=_(e,t,n,i,T,7,c[4]),i=_(i,e,t,n,O,12,c[5]),n=_(n,i,e,t,z,17,c[6]),t=_(t,n,i,e,D,22,c[7]),e=_(e,t,n,i,q,7,c[8]),i=_(i,e,t,n,N,12,c[9]),n=_(n,i,e,t,G,17,c[10]),t=_(t,n,i,e,E,22,c[11]),e=_(e,t,n,i,K,7,c[12]),i=_(i,e,t,n,Z,12,c[13]),n=_(n,i,e,t,H,17,c[14]),t=_(t,n,i,e,J,22,c[15]),e=B(e,t,n,i,x,5,c[16]),i=B(i,e,t,n,z,9,c[17]),n=B(n,i,e,t,E,14,c[18]),t=B(t,n,i,e,y,20,c[19]),e=B(e,t,n,i,O,5,c[20]),i=B(i,e,t,n,G,9,c[21]),n=B(n,i,e,t,J,14,c[22]),t=B(t,n,i,e,T,20,c[23]),e=B(e,t,n,i,N,5,c[24]),i=B(i,e,t,n,H,9,c[25]),n=B(n,i,e,t,R,14,c[26]),t=B(t,n,i,e,q,20,c[27]),e=B(e,t,n,i,Z,5,c[28]),i=B(i,e,t,n,L,9,c[29]),n=B(n,i,e,t,D,14,c[30]),t=B(t,n,i,e,K,20,c[31]),e=w(e,t,n,i,O,4,c[32]),i=w(i,e,t,n,q,11,c[33]),n=w(n,i,e,t,E,16,c[34]),t=w(t,n,i,e,H,23,c[35]),e=w(e,t,n,i,x,4,c[36]),i=w(i,e,t,n,T,11,c[37]),n=w(n,i,e,t,D,16,c[38]),t=w(t,n,i,e,G,23,c[39]),e=w(e,t,n,i,Z,4,c[40]),i=w(i,e,t,n,y,11,c[41]),n=w(n,i,e,t,R,16,c[42]),t=w(t,n,i,e,z,23,c[43]),e=w(e,t,n,i,N,4,c[44]),i=w(i,e,t,n,K,11,c[45]),n=w(n,i,e,t,J,16,c[46]),t=w(t,n,i,e,L,23,c[47]),e=$(e,t,n,i,y,6,c[48]),i=$(i,e,t,n,D,10,c[49]),n=$(n,i,e,t,H,15,c[50]),t=$(t,n,i,e,O,21,c[51]),e=$(e,t,n,i,K,6,c[52]),i=$(i,e,t,n,R,10,c[53]),n=$(n,i,e,t,G,15,c[54]),t=$(t,n,i,e,x,21,c[55]),e=$(e,t,n,i,q,6,c[56]),i=$(i,e,t,n,J,10,c[57]),n=$(n,i,e,t,z,15,c[58]),t=$(t,n,i,e,Z,21,c[59]),e=$(e,t,n,i,T,6,c[60]),i=$(i,e,t,n,E,10,c[61]),n=$(n,i,e,t,L,15,c[62]),t=$(t,n,i,e,N,21,c[63]),d[0]=d[0]+e|0,d[1]=d[1]+t|0,d[2]=d[2]+n|0,d[3]=d[3]+i|0},_doFinalize:function(){var v=this._data,g=v.words,j=this._nDataBytes*8,s=v.sigBytes*8;g[s>>>5]|=128<<24-s%32;var u=h.floor(j/4294967296),d=j;g[(s+64>>>9<<4)+15]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,g[(s+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,v.sigBytes=(g.length+1)*4,this._process();for(var y=this._hash,x=y.words,L=0;L<4;L++){var R=x[L];x[L]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360}return y},clone:function(){var v=p.clone.call(this);return v._hash=this._hash.clone(),v}});function _(v,g,j,s,u,d,y){var x=v+(g&j|~g&s)+u+y;return(x<<d|x>>>32-d)+g}function B(v,g,j,s,u,d,y){var x=v+(g&s|j&~s)+u+y;return(x<<d|x>>>32-d)+g}function w(v,g,j,s,u,d,y){var x=v+(g^j^s)+u+y;return(x<<d|x>>>32-d)+g}function $(v,g,j,s,u,d,y){var x=v+(j^(g|~s))+u+y;return(x<<d|x>>>32-d)+g}m.MD5=p._createHelper(C),m.HmacMD5=p._createHmacHelper(C)}(Math),a.MD5})}(ie)),ie.exports}st();for(const r in ue){r.charAt(0).toLowerCase()+r.slice(1);const o=new Ke(ue[r]);typeof o.color>"u"&&(o.color=ue[r]),o.toHex()}function ct(r,o,a){const h=new TextDecoder("utf-8"),m=h.decode(r),f="#".repeat(4),l=[f,a.name,f].join(" ");if(m.includes(l))return r;const p=h.decode(o).trim(),k=[m,"",l,p,l,""].join(`
`).trimStart();return new TextEncoder().encode(k)}function lt(r){if(r.length===0)return 0;if(r.length===1)return r[0].length;let o=0;const a=r[0];for(let h=0;h<a.length;h++){const m=a[h];if(r.every(f=>f[h]===m))o++;else break}return o}function xe(r,o,a,h="portable_config"){for(const l of["fonts","script-opts","shaders"])if(o.find(p=>p.path.startsWith(`${l}/`))){const p=o.filter(k=>k.path.startsWith(`${l}/`));o=o.filter(k=>!k.path.startsWith(`${l}/`));for(const k of p)k.path=`${h}/${l}/${k.path.replace(`${l}/`,"")}`,r.push(k)}if(o.find(l=>l.path.startsWith("scripts/"))){const l=o.filter(w=>w.path.startsWith("scripts/"));o=o.filter(w=>!w.path.startsWith("scripts/"));const p=l.map(w=>w.path.split("/")).map(w=>w.slice(1,w.length-1)),k=lt(p),C=`${(k?["scripts",...p[0].slice(0,k)]:["scripts"]).join("/")}/`,_=l.filter(w=>!w.path.replace(C,"").includes("/")&&w.path.endsWith(".lua")),B=l.filter(w=>!w.path.replace(C,"").includes("/")&&w.path.endsWith(".js"));_.length===1?_[0].path=`${a.scriptName||a.name}/main.lua`:B.length===1&&(B[0].path=`${a.scriptName||a.name}/main.js`);for(const w of l){const $=w.path.replace(C,`${a.scriptName||a.name}/`);w.path=`${h}/scripts/${$}`,r.push(w)}}if(o.find(l=>l.path.startsWith("externals/"))){const l=o.filter(p=>p.path.startsWith("externals/"));o=o.filter(p=>!p.path.startsWith("externals/"));for(const p of l)p.path=p.path.replace("externals/",""),r.push(p)}for(const l of["input.conf","mpv.conf"]){const p=o.findIndex(j=>j.path===l);if(p===-1)continue;const k=o.splice(p,1)[0],c=r.findIndex(j=>j.path===`${h}/${l}`);let C;c===-1?C=new te(`${h}/${l}`,new Uint8Array,void 0,!1,BigInt(Date.now())):C=r.splice(c,1)[0];const{path:_,mode:B,isDir:w,lastModified:$,buffer:v}=C,g=ct(v,k.buffer,a);r.push(new te(_,g,B,w,$))}if(o.find(l=>!l.path.includes("/")&&l.path.endsWith(".conf"))){const l=o.filter(p=>!p.path.includes("/")&&p.path.endsWith(".conf"));o=o.filter(p=>!(!p.path.includes("/")&&p.path.endsWith(".conf")));for(const p of l){const k=o.find(_=>_.path===p.path.replace(".conf",".js")),c=o.find(_=>_.path===p.path.replace(".conf",".lua")),C=k||c?`${h}/script-opts/${p.path}`:p.path;p.path=C,r.push(p)}}if(o.find(l=>!l.path.includes("/")&&pe(l.path))){const l=o.filter(p=>!p.path.includes("/")&&pe(p.path));o=o.filter(p=>!(!p.path.includes("/")&&pe(p.path)));for(const p of l)p.path=`${h}/fonts/${p.path}`,r.push(p)}const m=o.filter(l=>!l.path.includes("/")&&l.path.endsWith(".lua")),f=o.filter(l=>!l.path.includes("/")&&l.path.endsWith(".js"));m.length===1?m[0].path="main.lua":f.length===1&&(f[0].path="main.js");for(const l of o)l.path=`${h}/scripts/${a.scriptName||a.name}/${l.path}`,r.push(l)}const ft=[["thumbfast","mpv-easy-thumbfast"],["autoload","mpv-easy-autoload"],["uosc","mpv-easy","ModernX cyl0","ModernZ","mpv.net"]],Be={uosc:["autoload","mpv-easy-autoload"],"mpv-easy":["mpv-easy-anime4k","mpv-easy-clipboard-play","mpv-easy-copy-time","mpv-easy-cut","mpv-easy-translate","mpv-easy-autoload","mpv-easy-copy-screen","mpv-easy-crop","mpv-easy-thumbfast"]};function ut(r,o=ft){for(const m of o){const f=[];for(const l of r)m.includes(l)&&f.push(l);if(f.length>1)return f}const a=new Set,h=new Set(r);for(const m in r){const f=Be[m]||[];for(const l of f)h.has(l)&&(a.add(m),a.add(l))}return Array.from(a)}var pt=function(r){Se(r,[])},dt=function(r){pt(function(){r()})};function ht(r){try{const o=new URL(r);if(o.hostname!=="github.com")return;const a=o.pathname.split("/").filter(Boolean);return a.length<2?void 0:{user:a[0],repo:a[1]}}catch{return}}Ie(function(r,o){o._reactRoot||(o._reactRoot=_e(o));var a=o._reactRoot;return a.render(r),function(){return new Promise(function(h){setTimeout(function(){a.unmount(),h()},0)})}});const $e="https://cdn.jsdelivr.net";async function mt(r){const o=await fetch(r).then(a=>a.arrayBuffer());return new Uint8Array(o)}async function yt(r){const o=vt(r);if(!o)return[];const a=/<a[^>]+href="([^"]+)"[^>]*>([^<]+)<\/a>/g,h=[];for(const m of Array.from(o.matchAll(a),([,f,l])=>{const p=f.endsWith("/");return{path:f.split("/").slice(4).join("/"),url:$e+f,name:l,isDir:p}}))m.isDir||(m.buffer=await mt(m.url)),m.name!=="..."&&h.push(m);return h}function vt(r){const o=/<table[^>]*>([\s\S]*?)<\/table>/i,a=r.match(o);return a?a[1].trim():null}async function ke(r,o,a){const h=await fetch(a).then(l=>l.text()),m=await yt(h),f=[];for(const l of m)if(l.isDir){const p=a+l.path,k=await ke(r,o,p);for(const c of k)f.push(c)}else f.push(l);return f}function ye(r,o){const a=$e+`/gh/${r}/${o}/`;return ke(r,o,a)}const{defaultAlgorithm:gt,darkAlgorithm:wt}=Oe,{Search:bt}=Pe,{Title:xt,Link:_t}=P,St={getItem:r=>{const a=new URLSearchParams(location.hash.slice(1)).get(r)??"";return JSON.parse(a)},setItem:(r,o)=>{const a=new URLSearchParams(location.hash.slice(1));a.set(r,JSON.stringify(o)),location.hash=a.toString()},removeItem:r=>{const o=new URLSearchParams(location.hash.slice(1));o.delete(r),location.hash=o.toString()}},Bt=["mpv","mpv-v3","mpv.net"],Le={data:{},tableData:[],spinning:!1,selectedRowKeys:[],externalList:[],ui:"osc",platform:"mpv-v3",repos:[]},$t=Ze()(Je((r,o)=>({...Le,setData:a=>r({...o(),data:a}),setTableData:a=>r({...o(),tableData:a}),setSpinning:a=>r({...o(),spinning:a}),setSelectedKeys:a=>r({...o(),selectedRowKeys:a}),setExternalList:a=>r({...o(),externalList:a}),setUI:a=>r({...o(),ui:a}),setPlatform:a=>r({...o(),platform:a}),setState:a=>{r({...o(),...a})},setRepos:a=>r({...o(),repos:a})}),{name:"mpv-build",storage:Ve(()=>St),version:void 0,partialize:r=>Object.fromEntries(Object.entries(r).filter(([o])=>!["data","tableData","spinning"].includes(o)))})),he=150,me=150,kt=250;function ae(r,o){const a=new Blob([new Uint8Array(o)],{type:"application/octet-stream"}),h=URL.createObjectURL(a),m=document.createElement("a"),f=r.split("/").at(-1)??r;m.download=f,m.href=h,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(h)}function Lt(r,o,a,h){return`https://raw.githubusercontent.com/${r}/${o}/${a}/${h}`}function M(r){return Lt("ahaoboy","mpv-easy-cdn","main",r)}function jt(){return M("mpv-easy-play-with-windows.zip")}function Ct(){return M("yt-dlp.zip")}function Tt(){return M("ffmpeg-windows.tar.xz")}function Rt(){return M("ffmpeg-v3-windows.tar.xz")}const Q=[{name:"osc",repo:"https://github.com/mpv-player/mpv",deps:["autoload","thumbfast"],requires:[]},{name:"uosc",repo:"https://github.com/tomasklaen/uosc",deps:["thumbfast"],requires:["uosc"]},{name:"mpv-easy",repo:"https://github.com/mpv-easy/mpv-easy",deps:[],requires:["mpv-easy"]},{name:"modernx",repo:"https://github.com/cyl0/ModernX",deps:["thumbfast","autoload"],requires:["ModernX cyl0"]},{name:"modernz",repo:"https://github.com/Samillion/ModernZ",deps:["thumbfast","autoload"],requires:["ModernZ"]}],It=["ffmpeg","yt-dlp","play-with"];async function X(r){return fetch(r).then(o=>o.arrayBuffer()).then(o=>new Uint8Array(o))}function je(r){return M(`${r}.zip`)}async function Ot(r){if(r.repo)return(await ye(r.repo.user,r.repo.repo)).filter(l=>!l.isDir).map(({path:l,buffer:p})=>new te(l,p,void 0,!1,null));const{download:o}=r;if(![".js",".lua",".zip"].some(f=>o.endsWith(f)))return console.log("not support script: ",r),[];const a=je(r.name),h=await X(a);return F(ee(a),h).filter(f=>!f.isDir)}async function Pt(r,o){let a=M("mpv-windows.tar.xz");r==="mpv.net"&&(a=M("mpv.net.tar.xz"));const h=await X(a);return F(ee(a),h)||[]}function zt(){const r=$t(),o=Te(null),{data:a,tableData:h,spinning:m,selectedRowKeys:f,externalList:l,ui:p,setData:k,setTableData:c,setSpinning:C,setUI:_,setSelectedKeys:B,setExternalList:w,platform:$,setPlatform:v,setState:g,repos:j,setRepos:s}=r,u=p==="mpv-easy"?"mpv-easy":`mpv-${p}`,[d,y]=Re(window.matchMedia("(prefers-color-scheme: dark)").matches),x=Q.find(e=>e.name===p)?.requires||[],[L,R]=ze.useNotification(),T=()=>{g({...Le,data:a,tableData:h})},O=[...f,...Q.find(e=>e.name===p)?.requires||[]],z=async e=>{for(const t of O){const n=a[t];if(n.repo){const{user:i,repo:S}=n.repo,U=(await ye(i,S)).filter(Y=>!Y.isDir).map(({path:Y,buffer:Ce})=>new te(Y,Ce,void 0,!1,null)),V=`${i}-${S}`;xe(e,U,a[V])}else{const i=await Ot(a[t]);xe(e,i,a[t])}}},D=async()=>{const e=[];await z(e);for(const n of e)n.path=n.path.replace("portable_config/","");const t=le(fe.Zip,e);if(!t){console.log("zip file error");return}return t},q=async()=>{const e=await Pt($);if(l.includes("ffmpeg")){const n=$==="mpv-v3"?Rt():Tt(),i=await X(n),S=F(ee(n),i);for(const I of S)e.push(I)}if(l.includes("yt-dlp")){const n=Ct(),i=await X(n),S=F(ee(n),i);for(const I of S)e.push(I)}if(l.includes("play-with")){const n=jt(),i=await X(n),S=F(ee(n),i);for(const I of S)e.push(I)}z(e);const t=le(fe.Zip,e);if(!t){console.log("zip file error");return}return t},N=async()=>{C(!0),await new Promise(t=>setTimeout(t));const e=await q();C(!1),e&&ae(`${u}.zip`,e)},G=async()=>{C(!0),await new Promise(t=>setTimeout(t));const e=await D();C(!1),e&&ae("portable_config.zip",e)},E=async()=>{const e=M("scripts-full.json"),t=await fetch(e).then(S=>S.text()).then(S=>JSON.parse(S));for(const S in t)t[S].key=S;for(const{user:S,repo:I}of j){const U=`${S}-${I}`,V=`https://github.com/${S}/${I}`,Y={key:U,name:U,download:U,author:S,description:V,homepage:V,repo:{user:S,repo:I}};t[U]=Y}k(t);const n=f.map(S=>t[S]),i=Object.values(t).sort(()=>.5-Math.random()).filter(S=>!f.includes(S.name));c([...n,...i]),o.current=new Ge(Object.values(t),{keys:["name"]})};dt(E),Se(()=>{E()},[j]);const K=[{title:"name",dataIndex:"name",key:"key",render:(e,t)=>b(_t,{href:t.homepage,target:"_blank",rel:"noreferrer",children:t.name}),width:kt},{title:"description",dataIndex:"description",key:"key"},{title:"author",dataIndex:"author",key:"url"},{title:"download",dataIndex:"download",key:"url",render:(e,t)=>b(oe,{icon:b(ce,{}),onClick:async()=>{if(t.repo){const S=(await ye(t.repo.user,t.repo.repo)).filter(U=>!U.isDir).map(({path:U,buffer:V})=>new te(U,V,void 0,!1,null)),I=le(fe.Zip,S);I&&ae(`${t.repo.repo}.zip`,I);return}const n=await X(je(t.name));ae(`${t.name}.zip`,n)}},t.download)}],Z=(e,t,n)=>{const i=ht(e);if(i){B([...new Set([...f,`${i.user}-${i.repo}`])]),s([...new Set([...j,i])]);return}const S=o.current?.search(e);S?.length&&c(S.map(I=>I.item))};if(!Object.keys(a).length)return b(A,{className:"main",vertical:!0,gap:"middle",justify:"center",align:"center",children:b(P,{children:b(xt,{level:3,children:"Loading..."})})});const H=ut([...f,...Q.find(e=>e.name===p)?.requires||[]]),J=Be[p]||[];return W(De,{theme:{algorithm:d?wt:gt},children:[R,W(A,{className:["main",d?"main-dark":"main-light"].join(" "),vertical:!0,gap:"middle",justify:"center",align:"center",children:[W(A,{gap:"middle",justify:"center",align:"center",style:{position:"absolute",top:"1rem",right:"1rem"},children:[b(P.Link,{href:"https://github.com/mpv-easy/mpv-easy",target:"_blank",children:b(Me,{})}),b(P.Link,{href:"https://www.youtube.com/@mpveasy",target:"_blank",children:b(Ee,{})}),b(P.Link,{href:"https://x.com/mpv_easy",target:"_blank",children:b(He,{})}),d?b(P.Link,{onClick:()=>y(!1),children:b(qe,{})}):b(P.Link,{onClick:()=>y(!0),children:b(Ne,{})})]}),W(A,{gap:"middle",vertical:!0,align:"start",children:[W(A,{gap:"middle",justify:"center",align:"center",children:[b(P.Title,{level:5,style:{margin:0,width:he},children:b(ve,{title:"mpv-v3 is for newer CPUs (usually after 2005). If it doesn't run, please use mpv",children:"Platform:"})}),b(ne.Group,{value:$,onChange:e=>{v(e.target.value)},children:Bt.map(e=>b(ve,{placement:"topLeft",title:e==="mpv"?"Typically, you should use mpv-v3 unless it fails to run or you're using an older CPU (manufactured around 2015 or earlier).":"",children:b(ne,{value:e,style:{width:me},children:e},e)},e))})]}),W(A,{gap:"middle",justify:"center",align:"center",children:[b(P.Title,{level:5,style:{margin:0,width:he},children:"UI:"}),b(ne.Group,{onChange:e=>{_(e.target.value);const t=Q.find(n=>n.name===e.target.value)?.deps||[];B([...t])},value:p,children:Q.map(e=>b(ne,{value:e.name,style:{width:me},children:b(P.Link,{href:e.repo,target:"_blank",children:e.name})},e.name))})]}),W(A,{gap:"middle",justify:"center",align:"center",children:[b(P.Title,{level:5,style:{margin:0,width:he},children:"External:"}),b(ge.Group,{value:l,onChange:e=>{w(e)},children:It.map(e=>b(ge,{value:e,style:{width:me},children:e},e))})]})]}),b(bt,{placeholder:"input script name or https://github.com/<user>/<repo>",onSearch:Z,enterButton:!0}),b(Ue,{rowSelection:{hideSelectAll:!0,type:"checkbox",onSelect:(e,t)=>{B(t?[...f,e.name]:[...f].filter(n=>n!==e.name))},getCheckboxProps:e=>({disabled:x.includes(e.name)||J.includes(e.name),name:e.name}),selectedRowKeys:[...f,...x]},className:"table",columns:K,dataSource:h}),b(We,{spinning:m,fullscreen:!0}),W(A,{children:[b(re,{color:"processing",children:$},$),x.map((e,t)=>a[e]&&b(re,{color:"success",children:a[e]?.name},a[e]?.key+t)),l.map(e=>b(re,{color:"success",children:e},e)),f.map((e,t)=>b(re,{closable:!0,color:"success",onClose:n=>{const i=f.indexOf(a[e]?.key);if(i!==-1){const S=[...f];S.splice(i,1),B(S)}n.preventDefault()},children:a[e]?.name},a[e]?.key+t))]}),W(A,{gap:"middle",children:[b(oe,{color:"danger",size:"large",variant:"solid",onClick:T,children:"Reset"}),W(oe,{type:"primary",icon:b(ce,{}),size:"large",onClick:N,children:[u,".zip"]}),b(oe,{type:"primary",icon:b(ce,{}),size:"large",onClick:G,children:"portable_config.zip"})]}),!!H.length&&b(Ae,{description:`conflict: ${H.join(" ")}`,type:"error"})]})]})}_e(document.getElementById("root")).render(b(zt,{}));
